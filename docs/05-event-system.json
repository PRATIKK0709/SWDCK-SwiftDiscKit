{
  "title": "05 Event System",
  "content": "# Event System\n\nSWDCK uses an event-driven model. Your bot waits for \"Dispatch\" events from Discord (like a new message, a user joining, or a reaction) and reacts to them using registered handlers.\n\n## Registering Event Handlers\n\nYou register handlers using specific methods on the `DiscordBot` object. Each method takes a closure that is executed when the event occurs.\n\n```swift\nbot.onReady { readyData in\n    print(\"Bot is online as \\(readyData.user.username)\")\n}\n\nbot.onMessage { message in\n    print(\"New message: \\(message.content)\")\n}\n```\n\n## Async Event Handlers\n\nAll event handlers in SWDCK are **asynchronous**. This means you can perform network requests or other async operations directly inside the handler without blocking the rest of the bot.\n\n```swift\nbot.onMessage { message in\n    // You can call async methods here\n    try await message.reply(\"I received your message!\")\n}\n```\n\n## How Multiple Handlers Work\n\n> \u26a0\ufe0f **Needs verification:** Currently, calling an event registration method multiple times (e.g., calling `onMessage` twice) will **overwrite** the previous handler. It is recommended to have a single entry point for each event type and delegate the logic internally if needed.\n\n## Event Reference Table\n\n| Event Method | When It Fires | Payload Type | Key Fields |\n|--------------|--------------|--------------|------------|\n| `onReady` | Bot successfully connected and identified. | `ReadyData` | `user`, `guilds`, `sessionId` |\n| `onMessage` | A new message is created. | `Message` | `content`, `author`, `channelId` |\n| `onMessageUpdate` | A message is edited. | `Message` | `id`, `content`, `channelId` |\n| `onMessageDelete` | A message is deleted. | `MessageDelete` | `id`, `channelId`, `guildId` |\n| `onInteraction` | A slash command or component is used. | `Interaction` | `type`, `data`, `token` |\n| `onGuildCreate` | Bot joins a guild or guild becomes available. | `Guild` | `id`, `name`, `roles` |\n| `onMemberAdd` | A user joins a guild. | `GuildMemberAdd` | `user`, `guildId` |\n| `onReactionAdd` | A reaction is added to a message. | `MessageReaction` | `userId`, `messageId`, `emoji` |\n\n## Example: Handling Multiple Events\n\n```swift\nlet bot = DiscordBot(token: \"...\", intents: .default | .messageContent)\n\nbot.onReady { ready in\n    print(\"Logged in as \\(ready.user.username)\")\n}\n\nbot.onMessage { message in\n    if message.content == \"!hello\" {\n        try await message.reply(\"Hello there!\")\n    }\n}\n\ntry await bot.start()\n```\n\n> **Next:** [Messages](./messages)\n"
}